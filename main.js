/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TargetWordCountPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var SetTargetWordCountModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    this.plugin = plugin;
  }
  onOpen() {
    let { contentEl } = this;
    let targetWordCountInput;
    contentEl.createEl("h2", { text: "Set target word count" });
    new import_obsidian.Setting(contentEl).setName("Target Word Count").addText((text) => {
      text.setPlaceholder("Enter target word count...");
      targetWordCountInput = text.inputEl;
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Set").onClick(() => {
        const value = parseInt(targetWordCountInput.value);
        if (!isNaN(value) && value > 0) {
          this.plugin.setTargetWordCount(value);
          new import_obsidian.Notice(`Target word count set to ${value}`);
          this.close();
        } else {
          new import_obsidian.Notice("Please enter a valid number.");
        }
      });
    });
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};
var TargetWordCountPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.lastValidContent = "";
    this.currentWordCount = 0;
    this.targetWordCount = 0;
    this.targetReachedOnce = false;
    this.prevNewWords = 0;
    this.baselineWordCount = 0;
    this.pluginActive = false;
  }
  onload() {
    this.addCommand({
      id: "enable-target-word-count",
      name: "Set new",
      callback: () => {
        new SetTargetWordCountModal(this.app, this).open();
      }
    });
    this.addCommand({
      id: "reset-target-word-count-progress",
      name: "Reset",
      callback: () => {
        this.resetProgress();
      }
    });
    this.addCommand({
      id: "disable-target-word-count",
      name: "Stop",
      callback: () => {
        this.disablePlugin();
      }
    });
    this.statusBarItem = this.addStatusBarItem();
    this.updateStatusBar();
    this.registerEvent(this.app.workspace.on("editor-change", this.handleEditorChange.bind(this)));
    this.registerEvent(this.app.workspace.on("active-leaf-change", this.handleActiveLeafChange.bind(this)));
  }
  setTargetWordCount(num) {
    this.targetWordCount = num;
    if (!this.pluginActive) {
      this.registerEventListeners();
    }
    this.resetProgress();
  }
  disablePlugin() {
    this.app.workspace.off("editor-change", this.handleEditorChange.bind(this));
    this.app.workspace.off("active-leaf-change", this.handleActiveLeafChange.bind(this));
    this.pluginActive = false;
    this.targetWordCount = 0;
    this.updateStatusBar();
  }
  registerEventListeners() {
    this.registerEvent(this.app.workspace.on("editor-change", this.handleEditorChange.bind(this)));
    this.registerEvent(this.app.workspace.on("active-leaf-change", this.handleActiveLeafChange.bind(this)));
    this.pluginActive = true;
  }
  resetProgress() {
    this.targetReachedOnce = false;
    const editor = this.getCurrentEditor();
    if (editor) {
      this.lastValidContent = editor.getValue();
      const baselineWordCount = this.getWordCount(this.lastValidContent);
      this.currentWordCount = 0;
      this.baselineWordCount = baselineWordCount;
    }
    this.updateStatusBar();
  }
  handleEditorChange(instance, change) {
    const editor = this.getCurrentEditor();
    if (editor) {
      const content = editor.getValue();
      const currentCharCount = content.length;
      const totalWordCount = this.getWordCount(content);
      const newWordCount = totalWordCount - this.baselineWordCount + this.prevNewWords;
      if (currentCharCount < this.lastValidContent.length && !this.targetReachedOnce && this.pluginActive) {
        editor.setValue(this.lastValidContent);
        new import_obsidian.Notice("Target Word Count Plugin: Cannot delete characters until the target word count is reached. Use command Target Word Count: Stop to re-enable editing.");
      } else {
        this.lastValidContent = content;
        if (newWordCount >= 0) {
          this.currentWordCount = newWordCount;
        }
        if (this.currentWordCount >= this.targetWordCount && !this.targetReachedOnce) {
          this.targetReachedOnce = true;
        }
        this.updateStatusBar();
      }
    }
  }
  handleActiveLeafChange() {
    const editor = this.getCurrentEditor();
    if (editor) {
      const currentContent = editor.getValue();
      this.prevNewWords = this.currentWordCount;
      this.baselineWordCount = this.getWordCount(currentContent);
      this.lastValidContent = currentContent;
      this.updateStatusBar();
    }
  }
  getCurrentEditor() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    return activeView ? activeView.editor : null;
  }
  getWordCount(text) {
    return text.split(/\s+/).filter(Boolean).length;
  }
  updateStatusBar() {
    if (this.targetWordCount === 0) {
      this.statusBarItem.setText("");
    } else if (this.targetReachedOnce) {
      this.statusBarItem.setText(`Target word count reached. Edit freely.`);
    } else {
      this.statusBarItem.setText(`New Words: ${this.currentWordCount}/${this.targetWordCount}`);
    }
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBNb2RhbCwgU2V0dGluZywgQXBwLCBOb3RpY2UsIE1hcmtkb3duVmlldywgRWRpdG9yIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5cbmludGVyZmFjZSBQbHVnaW5TdGF0ZSB7XG4gICAgbGFzdFZhbGlkQ29udGVudDogc3RyaW5nO1xuICAgIGN1cnJlbnRXb3JkQ291bnQ6IG51bWJlcjtcbiAgICB0YXJnZXRXb3JkQ291bnQ6IG51bWJlcjtcbiAgICB0YXJnZXRSZWFjaGVkT25jZTogYm9vbGVhbjtcbiAgICBwcmV2TmV3V29yZHM6IG51bWJlcjtcbiAgICBiYXNlbGluZVdvcmRDb3VudDogbnVtYmVyO1xuICAgIHBsdWdpbkFjdGl2ZTogYm9vbGVhbjtcbn1cblxuXG5jbGFzcyBTZXRUYXJnZXRXb3JkQ291bnRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwbHVnaW46IFRhcmdldFdvcmRDb3VudFBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhcmdldFdvcmRDb3VudFBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGxldCB7Y29udGVudEVsfSA9IHRoaXM7XG4gICAgICAgIGxldCB0YXJnZXRXb3JkQ291bnRJbnB1dDogSFRNTElucHV0RWxlbWVudDtcblxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdTZXQgdGFyZ2V0IHdvcmQgY291bnQnfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1RhcmdldCBXb3JkIENvdW50JylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIHRhcmdldCB3b3JkIGNvdW50Li4uJylcbiAgICAgICAgICAgICAgICB0YXJnZXRXb3JkQ291bnRJbnB1dCA9IHRleHQuaW5wdXRFbDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IHtcbiAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCgnU2V0JylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZUludCh0YXJnZXRXb3JkQ291bnRJbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHZhbHVlKSAmJiB2YWx1ZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXRUYXJnZXRXb3JkQ291bnQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFRhcmdldCB3b3JkIGNvdW50IHNldCB0byAke3ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIGVudGVyIGEgdmFsaWQgbnVtYmVyLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIGxldCB7Y29udGVudEVsfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGFyZ2V0V29yZENvdW50UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBsYXN0VmFsaWRDb250ZW50ID0gXCJcIjtcbiAgICBjdXJyZW50V29yZENvdW50ID0gMDtcbiAgICB0YXJnZXRXb3JkQ291bnQgPSAwO1xuICAgIHRhcmdldFJlYWNoZWRPbmNlID0gZmFsc2U7XG4gICAgcHJldk5ld1dvcmRzID0gMDtcbiAgICBiYXNlbGluZVdvcmRDb3VudCA9IDA7XG4gICAgcGx1Z2luQWN0aXZlID0gZmFsc2U7XG4gICAgc3RhdHVzQmFySXRlbTogSFRNTEVsZW1lbnQ7XG5cbiAgICBvbmxvYWQoKSB7XG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2VuYWJsZS10YXJnZXQtd29yZC1jb3VudCcsXG4gICAgICAgICAgICBuYW1lOiAnU2V0IG5ldycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIG5ldyBTZXRUYXJnZXRXb3JkQ291bnRNb2RhbCh0aGlzLmFwcCwgdGhpcykub3BlbigpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAncmVzZXQtdGFyZ2V0LXdvcmQtY291bnQtcHJvZ3Jlc3MnLFxuICAgICAgICAgICAgbmFtZTogJ1Jlc2V0JyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldFByb2dyZXNzKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdkaXNhYmxlLXRhcmdldC13b3JkLWNvdW50JyxcbiAgICAgICAgICAgIG5hbWU6ICdTdG9wJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlUGx1Z2luKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW0gPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgdGhpcy5oYW5kbGVFZGl0b3JDaGFuZ2UuYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKFwiYWN0aXZlLWxlYWYtY2hhbmdlXCIsIHRoaXMuaGFuZGxlQWN0aXZlTGVhZkNoYW5nZS5iaW5kKHRoaXMpKSk7XG4gICAgfVxuXG4gICAgc2V0VGFyZ2V0V29yZENvdW50KG51bTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0V29yZENvdW50ID0gbnVtO1xuICAgICAgICAvLyBBY3RpdmF0ZSB0aGUgcGx1Z2luIGJ5IHJlZ2lzdGVyaW5nIGV2ZW50IGxpc3RlbmVycyBpZiBub3QgYWxyZWFkeSBhY3RpdmVcbiAgICAgICAgaWYgKCF0aGlzLnBsdWdpbkFjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXNldFByb2dyZXNzKCk7XG4gICAgfVxuXG4gICAgZGlzYWJsZVBsdWdpbigpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGV2ZW50IGxpc3RlbmVycyB0byBtYWtlIHRoZSBwbHVnaW4gZG9ybWFudFxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub2ZmKCdlZGl0b3ItY2hhbmdlJywgdGhpcy5oYW5kbGVFZGl0b3JDaGFuZ2UuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vZmYoJ2FjdGl2ZS1sZWFmLWNoYW5nZScsIHRoaXMuaGFuZGxlQWN0aXZlTGVhZkNoYW5nZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5wbHVnaW5BY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50YXJnZXRXb3JkQ291bnQgPSAwOyAvLyBPcHRpb25hbDogUmVzZXQgdGFyZ2V0IHdvcmQgY291bnQgb24gZGlzYWJsZVxuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgIH1cbiAgICBcbiAgICByZWdpc3RlckV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgdGhpcy5oYW5kbGVFZGl0b3JDaGFuZ2UuYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCB0aGlzLmhhbmRsZUFjdGl2ZUxlYWZDaGFuZ2UuYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnBsdWdpbkFjdGl2ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgcmVzZXRQcm9ncmVzcygpIHtcbiAgICAgICAgdGhpcy50YXJnZXRSZWFjaGVkT25jZSA9IGZhbHNlO1xuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEN1cnJlbnRFZGl0b3IoKTtcbiAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgdGhpcy5sYXN0VmFsaWRDb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAvLyBTZXQgYmFzZWxpbmUgd29yZCBjb3VudCB3aGVuIHRoZSB0YXJnZXQgbW9kZSBpcyBhY3RpdmF0ZWQgb3IgcmVzZXRcbiAgICAgICAgICAgIGNvbnN0IGJhc2VsaW5lV29yZENvdW50ID0gdGhpcy5nZXRXb3JkQ291bnQodGhpcy5sYXN0VmFsaWRDb250ZW50KTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFdvcmRDb3VudCA9IDA7IC8vIFJlc2V0IGN1cnJlbnQgbmV3IHdvcmQgY291bnRcbiAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBiYXNlbGluZSB3b3JkIGNvdW50IGZvciBjb21wYXJpc29uXG4gICAgICAgICAgICB0aGlzLmJhc2VsaW5lV29yZENvdW50ID0gYmFzZWxpbmVXb3JkQ291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICB9XG5cbiAgICBoYW5kbGVFZGl0b3JDaGFuZ2UoaW5zdGFuY2U6IGFueSwgY2hhbmdlOiBhbnkpIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5nZXRDdXJyZW50RWRpdG9yKCk7XG4gICAgICAgIGlmIChlZGl0b3IpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDaGFyQ291bnQgPSBjb250ZW50Lmxlbmd0aDtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsV29yZENvdW50ID0gdGhpcy5nZXRXb3JkQ291bnQoY29udGVudCk7XG4gICAgICAgICAgICBjb25zdCBuZXdXb3JkQ291bnQgPSB0b3RhbFdvcmRDb3VudCAtIHRoaXMuYmFzZWxpbmVXb3JkQ291bnQgKyB0aGlzLnByZXZOZXdXb3JkczsgLy8gQ2FsY3VsYXRlIG5ldyB3b3JkcyBhZGRlZFxuICAgIFxuICAgICAgICAgICAgLy8gVXNlIGNoYXJhY3RlciBjb3VudCB0byBkZXRlcm1pbmUgaWYgd2Ugc2hvdWxkIHJldmVydCBjaGFuZ2VzXG4gICAgICAgICAgICBpZiAoY3VycmVudENoYXJDb3VudCA8IHRoaXMubGFzdFZhbGlkQ29udGVudC5sZW5ndGggJiYgIXRoaXMudGFyZ2V0UmVhY2hlZE9uY2UgJiYgdGhpcy5wbHVnaW5BY3RpdmUpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0VmFsdWUodGhpcy5sYXN0VmFsaWRDb250ZW50KTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdUYXJnZXQgV29yZCBDb3VudCBQbHVnaW46IENhbm5vdCBkZWxldGUgY2hhcmFjdGVycyB1bnRpbCB0aGUgdGFyZ2V0IHdvcmQgY291bnQgaXMgcmVhY2hlZC4gVXNlIGNvbW1hbmQgVGFyZ2V0IFdvcmQgQ291bnQ6IFN0b3AgdG8gcmUtZW5hYmxlIGVkaXRpbmcuJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdFZhbGlkQ29udGVudCA9IGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIG9ubHkgaWYgbmV3IHdvcmRzIGhhdmUgYmVlbiBhZGRlZFxuICAgICAgICAgICAgICAgIGlmIChuZXdXb3JkQ291bnQgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRXb3JkQ291bnQgPSBuZXdXb3JkQ291bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRXb3JkQ291bnQgPj0gdGhpcy50YXJnZXRXb3JkQ291bnQgJiYgIXRoaXMudGFyZ2V0UmVhY2hlZE9uY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXRSZWFjaGVkT25jZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoYW5kbGVBY3RpdmVMZWFmQ2hhbmdlKCkge1xuICAgICAgICAvLyBPYnRhaW4gdGhlIGN1cnJlbnQgZWRpdG9yIGZvciB0aGUgbmV3bHkgZm9jdXNlZCBkb2N1bWVudFxuICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmdldEN1cnJlbnRFZGl0b3IoKTtcbiAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudENvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIHRoaXMucHJldk5ld1dvcmRzID0gdGhpcy5jdXJyZW50V29yZENvdW50O1xuICAgICAgICAgICAgdGhpcy5iYXNlbGluZVdvcmRDb3VudCA9IHRoaXMuZ2V0V29yZENvdW50KGN1cnJlbnRDb250ZW50KTtcbiAgICAgICAgICAgIHRoaXMubGFzdFZhbGlkQ29udGVudCA9IGN1cnJlbnRDb250ZW50O1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBcbiAgICBcblxuICAgIGdldEN1cnJlbnRFZGl0b3IoKSB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICByZXR1cm4gYWN0aXZlVmlldyA/IGFjdGl2ZVZpZXcuZWRpdG9yIDogbnVsbDtcbiAgICB9XG5cbiAgICBnZXRXb3JkQ291bnQodGV4dDogYW55KSB7XG4gICAgICAgIHJldHVybiB0ZXh0LnNwbGl0KC9cXHMrLykuZmlsdGVyKEJvb2xlYW4pLmxlbmd0aDtcbiAgICB9XG5cbiAgICB1cGRhdGVTdGF0dXNCYXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldFdvcmRDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldFRleHQoJycpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGFyZ2V0UmVhY2hlZE9uY2UpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFySXRlbS5zZXRUZXh0KGBUYXJnZXQgd29yZCBjb3VudCByZWFjaGVkLiBFZGl0IGZyZWVseS5gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFySXRlbS5zZXRUZXh0KGBOZXcgV29yZHM6ICR7dGhpcy5jdXJyZW50V29yZENvdW50fS8ke3RoaXMudGFyZ2V0V29yZENvdW50fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjog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
